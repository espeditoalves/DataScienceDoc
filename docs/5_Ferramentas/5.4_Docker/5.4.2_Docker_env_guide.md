# ğŸ³ Como usar `.env` com Docker Compose corretamente

Este guia explica como usar arquivos `.env` com o Docker Compose, especialmente quando o `.env` estÃ¡ fora da raiz do projeto, como na pasta `config/`.

---

## âœ… Objetivo

Permitir que o Docker Compose e seus containers usem variÃ¡veis de ambiente definidas em um arquivo `.env` localizado em `config/.env`.

---

## ğŸš« O Problema com `${VARIAVEL}` e `env_file:`

```yaml
env_file:
  - config/.env

environment:
  POSTGRES_USER: ${POSTGRES_USER}
  POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
```

Nesse exemplo, `${POSTGRES_USER}` **nÃ£o serÃ¡ resolvido a partir do `config/.env`**. O Docker Compose **tenta buscar essas variÃ¡veis do ambiente do seu sistema operacional (host)**, e **nÃ£o do `env_file:`**.

---

## âœ… SoluÃ§Ãµes possÃ­veis

### âœ… OpÃ§Ã£o 1: Usar somente `env_file:` (mais simples e recomendado)

```yaml
services:
  db:
    image: postgres:14
    container_name: container_postgres_financeiro
    env_file:
      - config/.env
```

> ğŸ“Œ **NÃ£o use `${VAR}` dentro de `environment:` nesse caso.**

---

### âœ… OpÃ§Ã£o 2: Mover o `.env` para a raiz do projeto

Estrutura:

```
.
â”œâ”€â”€ .env
â”œâ”€â”€ docker-compose.yml
```

```yaml
services:
  db:
    image: postgres:14
    container_name: container_postgres_financeiro
    environment:
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_DB: ${POSTGRES_DB}
```

> âœ… O Docker Compose **carrega automaticamente `.env` da raiz do projeto**.

---

### âœ… OpÃ§Ã£o 3: Usar flag `--env-file` no comando

MantÃ©m o `.env` na pasta `config/`, e executa com:

```bash
docker-compose --env-file config/.env up --build
```

```yaml
services:
  db:
    image: postgres:14
    container_name: container_postgres_financeiro
    environment:
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_DB: ${POSTGRES_DB}
```

> âœ… O Compose carrega as variÃ¡veis do `.env` como se estivessem no ambiente do host.

---

## ğŸ§  Comparativo final

| SituaÃ§Ã£o                            | `${VAR}` funciona? | `env_file:` necessÃ¡rio? | ObservaÃ§Ãµes                             |
|-------------------------------------|--------------------|--------------------------|------------------------------------------|
| `.env` na raiz do projeto           | âœ…                 | âŒ                       | Auto-carregado pelo Compose              |
| `env_file:` com `.env` em subpasta  | âŒ                 | âœ…                       | SÃ³ passa para o container                |
| Usando `--env-file` na linha de comando | âœ…              | âŒ                       | Precisa especificar manualmente no comando |

---

## âœ… Recomendado para seu caso

Se vocÃª quer manter `.env` dentro da pasta `config/`, use:

- Apenas `env_file:` no `docker-compose.yml`
- Ou `--env-file config/.env` no comando

---

Feito com ğŸ’™ por ChatGPT